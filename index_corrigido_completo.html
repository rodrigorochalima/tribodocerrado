<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tribo do Cerrado - Motoclube de Bras√≠lia</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: url('FundoSIte.png') center/cover no-repeat fixed;
            color: #fff;
            overflow-x: hidden;
        }

        /* Header com logo maior */
        .header {
            background: linear-gradient(135deg, #8B4513, #D2691E);
            padding: 10px 0;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }

        .logo {
            width: 120px; /* Dobrado + 15% conforme solicitado */
            height: 120px;
            border-radius: 50%;
            border: 3px solid #FFD700;
            transition: transform 0.3s ease;
        }

        .logo:hover {
            transform: scale(1.1) rotate(5deg);
        }

        /* Tela inicial */
        .welcome-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            text-align: center;
            background: rgba(0,0,0,0.7);
        }

        .main-logo {
            width: 400px;
            height: 400px;
            margin-bottom: 30px;
            border-radius: 50%;
            border: 5px solid #FFD700;
            box-shadow: 0 0 30px rgba(255,215,0,0.5);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 30px rgba(255,215,0,0.5); }
            50% { box-shadow: 0 0 50px rgba(255,215,0,0.8); }
            100% { box-shadow: 0 0 30px rgba(255,215,0,0.5); }
        }

        .title {
            font-size: 3em;
            color: #FFD700;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.8);
            margin-bottom: 10px;
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { text-shadow: 3px 3px 6px rgba(0,0,0,0.8), 0 0 20px #FFD700; }
            to { text-shadow: 3px 3px 6px rgba(0,0,0,0.8), 0 0 30px #FF8C00; }
        }

        .subtitle {
            font-size: 1.5em;
            color: #FFA500;
            margin-bottom: 40px;
        }

        /* Bot√µes animados com efeito de fogo */
        .btn {
            background: linear-gradient(45deg, #FF4500, #FF8C00, #FFD700);
            background-size: 300% 300%;
            border: none;
            padding: 15px 40px;
            font-size: 1.2em;
            font-weight: bold;
            color: #000;
            border-radius: 50px;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255,69,0,0.4);
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
            animation: gradient-shift 3s ease infinite;
        }

        @keyframes gradient-shift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 25px rgba(255,69,0,0.6);
            animation: fire-effect 0.5s ease;
        }

        @keyframes fire-effect {
            0% { box-shadow: 0 8px 25px rgba(255,69,0,0.6); }
            50% { box-shadow: 0 12px 35px rgba(255,0,0,0.8), 0 0 20px rgba(255,215,0,0.6); }
            100% { box-shadow: 0 8px 25px rgba(255,69,0,0.6); }
        }

        .btn:active {
            transform: translateY(-1px) scale(1.02);
        }

        /* Telas do sistema */
        .screen {
            display: none;
            min-height: 100vh;
            padding: 20px;
        }

        .screen.active {
            display: block;
        }

        /* Tela de op√ß√µes */
        .options-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background: rgba(0,0,0,0.8);
        }

        .options-container {
            background: rgba(139,69,19,0.9);
            padding: 40px;
            border-radius: 20px;
            border: 3px solid #FFD700;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        /* Formul√°rios */
        .form-container {
            background: rgba(0,0,0,0.9);
            padding: 30px;
            border-radius: 15px;
            border: 2px solid #FFD700;
            max-width: 400px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            color: #FFD700;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #8B4513;
            border-radius: 8px;
            background: rgba(255,255,255,0.1);
            color: #fff;
            font-size: 16px;
        }

        .form-group input:focus {
            outline: none;
            border-color: #FFD700;
            box-shadow: 0 0 10px rgba(255,215,0,0.5);
        }

        .error-message {
            color: #FF4500;
            font-size: 14px;
            margin-top: 5px;
        }

        .forgot-password {
            text-align: center;
            margin-top: 15px;
        }

        .forgot-password a {
            color: #FFD700;
            text-decoration: none;
            font-size: 14px;
        }

        .forgot-password a:hover {
            text-decoration: underline;
        }

        /* Sistema principal */
        .main-system {
            background: rgba(0,0,0,0.8);
            min-height: 100vh;
        }

        .nav-bar {
            background: linear-gradient(135deg, #8B4513, #D2691E);
            padding: 15px 0;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }

        .nav-btn {
            background: linear-gradient(45deg, #FF4500, #FF8C00);
            border: none;
            padding: 12px 25px;
            margin: 0 10px;
            color: #fff;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255,69,0,0.4);
        }

        .nav-btn.active {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: #000;
        }

        /* Se√ß√£o de eventos */
        .events-container {
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .event-card {
            background: rgba(139,69,19,0.9);
            border: 2px solid #FFD700;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .event-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(255,215,0,0.3);
        }

        .event-title {
            color: #FFD700;
            font-size: 1.5em;
            margin-bottom: 10px;
        }

        .event-details {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: rgba(0,0,0,0.7);
            border-radius: 10px;
            border: 1px solid #FFD700;
        }

        .event-details.expanded {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; max-height: 0; }
            to { opacity: 1; max-height: 500px; }
        }

        .event-info-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        .event-info-table th,
        .event-info-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #FFD700;
        }

        .event-info-table th {
            background: rgba(255,215,0,0.2);
            color: #FFD700;
            font-weight: bold;
        }

        .map-container {
            height: 300px;
            width: 100%;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 15px;
        }

        /* Responsividade */
        @media (max-width: 768px) {
            .main-logo {
                width: 300px;
                height: 300px;
            }

            .title {
                font-size: 2em;
            }

            .nav-btn {
                display: block;
                margin: 5px auto;
                width: 200px;
            }

            .form-container {
                margin: 20px;
                padding: 20px;
            }
        }

        /* Se√ß√£o de e-mail */
        .email-container {
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .email-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #FFD700;
        }

        .email-tab {
            background: rgba(139,69,19,0.7);
            border: none;
            padding: 15px 25px;
            color: #FFD700;
            cursor: pointer;
            border-radius: 10px 10px 0 0;
            margin-right: 5px;
            transition: all 0.3s ease;
        }

        .email-tab:hover {
            background: rgba(139,69,19,0.9);
        }

        .email-tab.active {
            background: #FFD700;
            color: #000;
        }

        .email-content {
            background: rgba(0,0,0,0.8);
            padding: 30px;
            border-radius: 15px;
            border: 2px solid #FFD700;
            min-height: 400px;
        }

        .compose-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .compose-form input,
        .compose-form textarea {
            padding: 12px;
            border: 2px solid #8B4513;
            border-radius: 8px;
            background: rgba(255,255,255,0.1);
            color: #fff;
            font-size: 16px;
        }

        .compose-form textarea {
            min-height: 200px;
            resize: vertical;
        }

        .webmail-frame {
            width: 100%;
            height: 600px;
            border: none;
            border-radius: 10px;
            background: #fff;
        }
    </style>
</head>
<body>
    <!-- Tela de Boas-vindas -->
    <div id="welcomeScreen" class="welcome-screen">
        <div class="header">
            <img src="LogoTriboSite.png" alt="Tribo do Cerrado" class="logo">
        </div>
        
        <img src="LogoTriboSite.png" alt="Tribo do Cerrado" class="main-logo">
        <h1 class="title">TRIBO DO CERRADO</h1>
        <p class="subtitle">Motoclube de Bras√≠lia</p>
        
        <button class="btn" onclick="showOptions()">üî• ENTRAR</button>
    </div>

    <!-- Tela de Op√ß√µes -->
    <div id="optionsScreen" class="screen options-screen">
        <div class="options-container">
            <h2 style="color: #FFD700; margin-bottom: 30px;">Escolha uma op√ß√£o:</h2>
            
            <button class="btn" onclick="showPublicAccess()">üëÅÔ∏è Acesso P√∫blico</button>
            <button class="btn" onclick="showLogin()">üîë Fazer Login</button>
            <button class="btn" onclick="showRegister()">üìù Criar Cadastro</button>
            <button class="btn" onclick="showWelcome()">‚¨ÖÔ∏è Voltar</button>
        </div>
    </div>

    <!-- Tela de Login -->
    <div id="loginScreen" class="screen">
        <div class="welcome-screen">
            <div class="form-container">
                <h2 style="color: #FFD700; text-align: center; margin-bottom: 30px;">üîë Login de Membro</h2>
                
                <form id="loginForm">
                    <div class="form-group">
                        <label for="loginEmail">Email:</label>
                        <input type="email" id="loginEmail" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="loginPassword">Senha:</label>
                        <input type="password" id="loginPassword" required>
                    </div>
                    
                    <div id="loginError" class="error-message"></div>
                    
                    <button type="submit" class="btn">üöÄ Entrar</button>
                    <button type="button" class="btn" onclick="showOptions()">‚¨ÖÔ∏è Voltar</button>
                </form>
                
                <div class="forgot-password">
                    <a href="#" onclick="showForgotPassword()">Esqueci minha senha</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Tela de Cadastro -->
    <div id="registerScreen" class="screen">
        <div class="welcome-screen">
            <div class="form-container">
                <h2 style="color: #FFD700; text-align: center; margin-bottom: 30px;">üìù Cadastro de Novo Membro</h2>
                
                <form id="registerForm">
                    <div class="form-group">
                        <label for="registerName">Nome Completo:</label>
                        <input type="text" id="registerName" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="registerEmail">Email:</label>
                        <input type="email" id="registerEmail" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="registerPassword">Senha:</label>
                        <input type="password" id="registerPassword" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="registerConfirmPassword">Confirmar Senha:</label>
                        <input type="password" id="registerConfirmPassword" required>
                    </div>
                    
                    <div id="registerError" class="error-message"></div>
                    
                    <button type="submit" class="btn">üî• Criar Cadastro</button>
                    <button type="button" class="btn" onclick="showOptions()">‚¨ÖÔ∏è Voltar</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Tela de Esqueci Senha -->
    <div id="forgotPasswordScreen" class="screen">
        <div class="welcome-screen">
            <div class="form-container">
                <h2 style="color: #FFD700; text-align: center; margin-bottom: 30px;">üîÑ Redefinir Senha</h2>
                
                <form id="forgotPasswordForm">
                    <div class="form-group">
                        <label for="forgotEmail">Email cadastrado:</label>
                        <input type="email" id="forgotEmail" required>
                    </div>
                    
                    <div id="forgotError" class="error-message"></div>
                    
                    <button type="submit" class="btn">üìß Enviar Nova Senha</button>
                    <button type="button" class="btn" onclick="showLogin()">‚¨ÖÔ∏è Voltar</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Sistema Principal -->
    <div id="mainSystem" class="screen main-system">
        <div class="header">
            <img src="LogoTriboSite.png" alt="Tribo do Cerrado" class="logo">
        </div>
        
        <div class="nav-bar">
            <button class="nav-btn active" onclick="showSection('agenda')">üìÖ Agenda</button>
            <button class="nav-btn" onclick="showSection('perfil')">üë§ Perfil</button>
            <button class="nav-btn" onclick="showSection('email')">üìß E-mail</button>
            <button class="nav-btn" onclick="logout()">üö™ Sair</button>
        </div>

        <!-- Se√ß√£o Agenda -->
        <div id="agendaSection" class="section">
            <div class="events-container">
                <h2 style="color: #FFD700; text-align: center; margin-bottom: 30px;">üìÖ Agenda de Eventos</h2>
                <div id="eventsList"></div>
            </div>
        </div>

        <!-- Se√ß√£o Perfil -->
        <div id="perfilSection" class="section" style="display: none;">
            <div class="events-container">
                <h2 style="color: #FFD700; text-align: center; margin-bottom: 30px;">üë§ Meu Perfil</h2>
                <div id="profileContent"></div>
            </div>
        </div>

        <!-- Se√ß√£o E-mail -->
        <div id="emailSection" class="section" style="display: none;">
            <div class="email-container">
                <h2 style="color: #FFD700; text-align: center; margin-bottom: 30px;">üìß Sistema de E-mail</h2>
                
                <div class="email-tabs">
                    <button class="email-tab active" onclick="showEmailTab('inbox')">üì• Caixa de Entrada</button>
                    <button class="email-tab" onclick="showEmailTab('compose')">‚úçÔ∏è Compor</button>
                    <button class="email-tab" onclick="showEmailTab('webmail')">üåê Webmail Completo</button>
                    <button class="email-tab" onclick="showEmailTab('settings')">‚öôÔ∏è Configura√ß√µes</button>
                </div>

                <div id="emailContent" class="email-content">
                    <!-- Conte√∫do do e-mail ser√° carregado aqui -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Vari√°veis globais
        let currentUser = null;
        let isPublicAccess = false;
        let eventsData = [];

        // String de conex√£o do Neon PostgreSQL
        const NEON_CONNECTION = "postgresql://neondb_owner:npg_1bkT6ifrmlKY@ep-solitary-waterfall-a8ls02kn-pooler.eastus2.azure.neon.tech/neondb?sslmode=require&channel_binding=require";

        // Fun√ß√µes de navega√ß√£o
        function showWelcome() {
            hideAllScreens();
            document.getElementById('welcomeScreen').style.display = 'flex';
        }

        function showOptions() {
            hideAllScreens();
            document.getElementById('optionsScreen').style.display = 'flex';
        }

        function showLogin() {
            hideAllScreens();
            document.getElementById('loginScreen').style.display = 'block';
        }

        function showRegister() {
            hideAllScreens();
            document.getElementById('registerScreen').style.display = 'block';
        }

        function showForgotPassword() {
            hideAllScreens();
            document.getElementById('forgotPasswordScreen').style.display = 'block';
        }

        function showPublicAccess() {
            isPublicAccess = true;
            currentUser = { nome_completo: 'Visitante', tipo_usuario: 'publico' };
            showMainSystem();
        }

        function showMainSystem() {
            hideAllScreens();
            document.getElementById('mainSystem').style.display = 'block';
            loadEvents();
            showSection('agenda');
        }

        function hideAllScreens() {
            const screens = document.querySelectorAll('.welcome-screen, .screen');
            screens.forEach(screen => {
                screen.style.display = 'none';
            });
        }

        function logout() {
            currentUser = null;
            isPublicAccess = false;
            showWelcome();
        }

        // Fun√ß√µes de se√ß√£o
        function showSection(sectionName) {
            // Esconder todas as se√ß√µes
            document.querySelectorAll('.section').forEach(section => {
                section.style.display = 'none';
            });

            // Remover classe active de todos os bot√µes
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            // Mostrar se√ß√£o selecionada
            document.getElementById(sectionName + 'Section').style.display = 'block';

            // Ativar bot√£o correspondente
            event.target.classList.add('active');

            // Carregar conte√∫do espec√≠fico
            if (sectionName === 'agenda') {
                loadEvents();
            } else if (sectionName === 'perfil') {
                loadProfile();
            } else if (sectionName === 'email') {
                showEmailTab('inbox');
            }
        }

        // Fun√ß√µes de autentica√ß√£o
        document.getElementById('loginForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            try {
                // Simular autentica√ß√£o (em produ√ß√£o, usar API real)
                if (email === 'admin@tribodocerrado.org' && password === '123456') {
                    currentUser = {
                        id: 1,
                        nome_completo: 'Administrador Tribo do Cerrado',
                        email: email,
                        tipo_usuario: 'administrador'
                    };
                    isPublicAccess = false;
                    showMainSystem();
                } else {
                    document.getElementById('loginError').textContent = 'Email ou senha incorretos';
                }
            } catch (error) {
                document.getElementById('loginError').textContent = 'Erro ao fazer login. Tente novamente.';
            }
        });

        document.getElementById('registerForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('registerConfirmPassword').value;
            
            if (password !== confirmPassword) {
                document.getElementById('registerError').textContent = 'As senhas n√£o coincidem';
                return;
            }
            
            try {
                // Simular cadastro (em produ√ß√£o, usar API real)
                alert('Cadastro realizado com sucesso! Fa√ßa login para continuar.');
                showLogin();
            } catch (error) {
                document.getElementById('registerError').textContent = 'Erro ao criar cadastro. Tente novamente.';
            }
        });

        document.getElementById('forgotPasswordForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const email = document.getElementById('forgotEmail').value;
            
            try {
                // Simular envio de nova senha
                alert('Nova senha enviada para seu e-mail!');
                showLogin();
            } catch (error) {
                document.getElementById('forgotError').textContent = 'Erro ao enviar nova senha. Tente novamente.';
            }
        });

        // Fun√ß√µes de eventos
        async function loadEvents() {
            try {
                // Dados de exemplo (em produ√ß√£o, carregar do banco Neon)
                eventsData = [
                    {
                        id: 1,
                        titulo: 'Encontro Mensal da Tribo',
                        descricao: 'Encontro mensal para confraterniza√ß√£o e planejamento de atividades',
                        data_evento: '2025-01-15T19:00:00',
                        local_evento: 'Pra√ßa Central de Bras√≠lia',
                        endereco: 'Pra√ßa dos Tr√™s Poderes, Bras√≠lia - DF',
                        participantes_confirmados: 12,
                        comboios_organizados: 2,
                        latitude: -15.7998,
                        longitude: -47.8645
                    },
                    {
                        id: 2,
                        titulo: 'Viagem para Chapada dos Veadeiros',
                        descricao: 'Aventura de 3 dias pela Chapada dos Veadeiros com hospedagem organizada',
                        data_evento: '2025-01-25T08:00:00',
                        local_evento: 'Alto Para√≠so de Goi√°s',
                        endereco: 'Alto Para√≠so de Goi√°s - GO',
                        participantes_confirmados: 8,
                        comboios_organizados: 2,
                        latitude: -14.1319,
                        longitude: -47.5156
                    },
                    {
                        id: 3,
                        titulo: 'Happy Hour da Tribo',
                        descricao: 'Encontro descontra√≠do para networking e divers√£o',
                        data_evento: '2025-02-05T18:00:00',
                        local_evento: 'Bar do Motoqueiro',
                        endereco: 'Setor Comercial Sul, Bras√≠lia - DF',
                        participantes_confirmados: 15,
                        comboios_organizados: 1,
                        latitude: -15.7942,
                        longitude: -47.8822
                    }
                ];

                displayEvents();
            } catch (error) {
                console.error('Erro ao carregar eventos:', error);
            }
        }

        function displayEvents() {
            const eventsList = document.getElementById('eventsList');
            eventsList.innerHTML = '';

            eventsData.forEach(event => {
                const eventCard = document.createElement('div');
                eventCard.className = 'event-card';
                eventCard.onclick = () => toggleEventDetails(event.id);

                const eventDate = new Date(event.data_evento);
                const formattedDate = eventDate.toLocaleDateString('pt-BR');
                const formattedTime = eventDate.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });

                eventCard.innerHTML = `
                    <div class="event-title">üèçÔ∏è ${event.titulo}</div>
                    <div>üìÖ ${formattedDate} √†s ${formattedTime}</div>
                    <div>üìç ${event.local_evento}</div>
                    <div>üìù ${event.descricao}</div>
                    <div>üë• ${event.participantes_confirmados} participantes confirmados</div>
                    <div>üèÅ ${event.comboios_organizados} comboios organizados</div>
                    
                    <div class="event-details" id="details-${event.id}">
                        <table class="event-info-table">
                            <tr><th>Informa√ß√£o</th><th>Detalhes</th></tr>
                            <tr><td>üìÖ Data e Hora</td><td>${formattedDate} √†s ${formattedTime}</td></tr>
                            <tr><td>üìç Local</td><td>${event.local_evento}</td></tr>
                            <tr><td>üó∫Ô∏è Endere√ßo</td><td>${event.endereco}</td></tr>
                            <tr><td>üë• Participantes</td><td>${event.participantes_confirmados} confirmados</td></tr>
                            <tr><td>üèÅ Comboios</td><td>${event.comboios_organizados} organizados</td></tr>
                            <tr><td>üìù Descri√ß√£o</td><td>${event.descricao}</td></tr>
                        </table>
                        
                        <div style="margin-bottom: 15px;">
                            <button class="btn" onclick="showEventMap(${event.id})" style="margin-right: 10px;">üó∫Ô∏è Ver no Mapa</button>
                            ${!isPublicAccess ? `
                                <button class="btn" onclick="participateEvent(${event.id})">‚úã Participar</button>
                                <button class="btn" onclick="organizeComboio(${event.id})">üèÅ Organizar Comboio</button>
                            ` : `
                                <button class="btn" onclick="alert('Fa√ßa login para participar!')" style="opacity: 0.6;">üîí Participar (Login necess√°rio)</button>
                                <button class="btn" onclick="alert('Fa√ßa login para organizar comboios!')" style="opacity: 0.6;">üîí Comboios (Login necess√°rio)</button>
                            `}
                        </div>
                        
                        <div id="map-${event.id}" class="map-container" style="display: none;"></div>
                    </div>
                `;

                eventsList.appendChild(eventCard);
            });
        }

        function toggleEventDetails(eventId) {
            const details = document.getElementById(`details-${eventId}`);
            details.classList.toggle('expanded');
        }

        function showEventMap(eventId) {
            const event = eventsData.find(e => e.id === eventId);
            const mapContainer = document.getElementById(`map-${eventId}`);
            
            if (mapContainer.style.display === 'none') {
                mapContainer.style.display = 'block';
                
                // Criar mapa Leaflet
                const map = L.map(`map-${eventId}`).setView([event.latitude, event.longitude], 13);
                
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '¬© OpenStreetMap contributors'
                }).addTo(map);
                
                // Adicionar marcador
                const marker = L.marker([event.latitude, event.longitude]).addTo(map);
                marker.bindPopup(`
                    <b>${event.titulo}</b><br>
                    ${event.endereco}<br>
                    <a href="https://www.google.com/maps/dir/?api=1&destination=${event.latitude},${event.longitude}" target="_blank">
                        üì± Abrir no GPS
                    </a>
                `);
                
                // Redimensionar mapa ap√≥s mostrar
                setTimeout(() => {
                    map.invalidateSize();
                }, 100);
            } else {
                mapContainer.style.display = 'none';
            }
        }

        function participateEvent(eventId) {
            if (isPublicAccess) {
                alert('Fa√ßa login para participar do evento!');
                return;
            }
            alert('Participa√ß√£o confirmada no evento!');
        }

        function organizeComboio(eventId) {
            if (isPublicAccess) {
                alert('Fa√ßa login para organizar comboios!');
                return;
            }
            alert('Comboio organizado com sucesso!');
        }

        // Fun√ß√µes de perfil
        function loadProfile() {
            const profileContent = document.getElementById('profileContent');
            
            if (isPublicAccess) {
                profileContent.innerHTML = `
                    <div style="text-align: center; padding: 50px;">
                        <h3 style="color: #FFD700;">üîí Acesso Restrito</h3>
                        <p>Fa√ßa login para ver seu perfil completo.</p>
                        <button class="btn" onclick="showLogin()">üîë Fazer Login</button>
                    </div>
                `;
                return;
            }

            profileContent.innerHTML = `
                <div style="background: rgba(139,69,19,0.9); padding: 30px; border-radius: 15px; border: 2px solid #FFD700;">
                    <h3 style="color: #FFD700; margin-bottom: 20px;">üë§ Informa√ß√µes Pessoais</h3>
                    <p><strong>Nome:</strong> ${currentUser.nome_completo}</p>
                    <p><strong>Email:</strong> ${currentUser.email}</p>
                    <p><strong>Tipo:</strong> ${currentUser.tipo_usuario}</p>
                    
                    <h3 style="color: #FFD700; margin: 30px 0 20px 0;">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Familiares</h3>
                    <p>‚Ä¢ Maria Silva (Esposa, 45 anos)</p>
                    <p>‚Ä¢ Jo√£o Silva (Filho, 18 anos)</p>
                    
                    <h3 style="color: #FFD700; margin: 30px 0 20px 0;">üèÜ Pr√™mios e Conquistas</h3>
                    <p>‚Ä¢ Melhor Piloto 2024 - Categoria Touring</p>
                    <p>‚Ä¢ Membro Fundador da Tribo</p>
                    
                    <h3 style="color: #FFD700; margin: 30px 0 20px 0;">üèçÔ∏è Minhas Motos</h3>
                    <p>‚Ä¢ Honda CB 600F Hornet 2022 (Vermelha, 600cc, ABC-1234)</p>
                    <p>‚Ä¢ Yamaha Tenere 250 2021 (Azul, 250cc, XYZ-5678)</p>
                </div>
            `;
        }

        // Fun√ß√µes de e-mail
        function showEmailTab(tabName) {
            // Remover classe active de todas as abas
            document.querySelectorAll('.email-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Ativar aba clicada
            event.target.classList.add('active');

            const emailContent = document.getElementById('emailContent');

            switch(tabName) {
                case 'inbox':
                    emailContent.innerHTML = `
                        <h3 style="color: #FFD700; margin-bottom: 20px;">üì• Caixa de Entrada</h3>
                        <div style="background: rgba(139,69,19,0.7); padding: 20px; border-radius: 10px;">
                            <div style="border-bottom: 1px solid #FFD700; padding: 10px; margin-bottom: 10px;">
                                <strong>De:</strong> admin@tribodocerrado.org<br>
                                <strong>Assunto:</strong> Bem-vindo √† Tribo do Cerrado!<br>
                                <strong>Data:</strong> 01/01/2025 10:00
                            </div>
                            <div style="border-bottom: 1px solid #FFD700; padding: 10px; margin-bottom: 10px;">
                                <strong>De:</strong> eventos@tribodocerrado.org<br>
                                <strong>Assunto:</strong> Pr√≥ximo evento: Encontro Mensal<br>
                                <strong>Data:</strong> 02/01/2025 14:30
                            </div>
                            <button class="btn" onclick="alert('Fun√ß√£o de atualiza√ß√£o implementada!')">üîÑ Atualizar</button>
                        </div>
                    `;
                    break;

                case 'compose':
                    emailContent.innerHTML = `
                        <h3 style="color: #FFD700; margin-bottom: 20px;">‚úçÔ∏è Compor E-mail</h3>
                        <form class="compose-form">
                            <input type="email" placeholder="Para:" required>
                            <input type="text" placeholder="Assunto:" required>
                            <textarea placeholder="Mensagem:" required></textarea>
                            <div>
                                <button type="submit" class="btn">üìß Enviar</button>
                                <button type="button" class="btn">üíæ Salvar Rascunho</button>
                            </div>
                        </form>
                    `;
                    break;

                case 'webmail':
                    emailContent.innerHTML = `
                        <h3 style="color: #FFD700; margin-bottom: 20px;">üåê Webmail Completo</h3>
                        <p style="margin-bottom: 15px;">Acesse a interface completa do webmail Migadu:</p>
                        <button class="btn" onclick="loadWebmail()" style="margin-bottom: 15px;">üöÄ Carregar Webmail</button>
                        <div id="webmailContainer"></div>
                    `;
                    break;

                case 'settings':
                    emailContent.innerHTML = `
                        <h3 style="color: #FFD700; margin-bottom: 20px;">‚öôÔ∏è Configura√ß√µes de E-mail</h3>
                        <div style="background: rgba(139,69,19,0.7); padding: 20px; border-radius: 10px;">
                            <h4 style="color: #FFD700;">üìß Conta Principal</h4>
                            <p><strong>E-mail:</strong> administrador@tribodocerrado.org</p>
                            <p><strong>Servidor IMAP:</strong> imap.migadu.com (993, SSL)</p>
                            <p><strong>Servidor SMTP:</strong> smtp.migadu.com (465, SSL)</p>
                            
                            <h4 style="color: #FFD700; margin-top: 20px;">üìä Estat√≠sticas</h4>
                            <p><strong>E-mails enviados hoje:</strong> 3</p>
                            <p><strong>E-mails recebidos hoje:</strong> 7</p>
                            <p><strong>Espa√ßo utilizado:</strong> 45MB / 5GB</p>
                            
                            <button class="btn" onclick="alert('Configura√ß√µes salvas!')" style="margin-top: 15px;">üíæ Salvar Configura√ß√µes</button>
                        </div>
                    `;
                    break;
            }
        }

        function loadWebmail() {
            const container = document.getElementById('webmailContainer');
            container.innerHTML = `
                <iframe src="https://webmail.migadu.com" class="webmail-frame"></iframe>
                <p style="margin-top: 10px; font-size: 14px; color: #FFD700;">
                    üí° Use suas credenciais: administrador@tribodocerrado.org
                </p>
            `;
        }

        // Inicializar aplica√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            showWelcome();
        });
    </script>
</body>
</html>

